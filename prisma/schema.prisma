generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model categorias {
  id        BigInt     @id @default(autoincrement())
  nome      String     @db.VarChar(100)
  descricao String?
  criado_em DateTime?  @default(now()) @db.Timestamp(6)
  produtos  produtos[]
}

model produtos {
  id             BigInt      @id @default(autoincrement())
  categoria_id   BigInt?
  sku            String      @unique @db.VarChar(50)
  nome           String      @db.VarChar(255)
  estoque_minimo Int?        @default(0)
  marca          String?     @default("Generico") @db.VarChar(100)
  criado_em      DateTime?   @default(now()) @db.Timestamp(6)
  categorias categorias? @relation(fields: [categoria_id], references: [id])
  estoque              estoque?
  estoque_movimentacoes estoque_movimentacoes[]
}

enum tipo_movimentacao {
  entrada
  saida
}

model estoque {
  id            BigInt   @id @default(autoincrement())
  produto_id    BigInt   @unique
  quantidade    Int      @default(0)
  atualizado_em DateTime @default(now()) @db.Timestamp(6)
  produtos produtos @relation(fields: [produto_id], references: [id], onDelete: Cascade)
}

model estoque_movimentacoes {
  id         BigInt             @id @default(autoincrement())
  produto_id BigInt
  quantidade Int
  tipo       tipo_movimentacao
  criado_em  DateTime           @default(now()) @db.Timestamp(6)
  produtos produtos @relation(fields: [produto_id], references: [id], onDelete: Cascade)
}
